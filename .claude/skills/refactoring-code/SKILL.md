---
name: refactoring-code
description: リファクタリングの原則と手順を提供する。「リファクタリングして」「コードを整理して」「改善して」「可読性を上げて」といった依頼、またはコードの可読性・保守性向上が必要な場合に使用する。
---

# リファクタリングガイド

## 概要

**目的**: Martin Fowler 流のリファクタリング原則に基づき、コードの可読性と保守性を向上させる。

リファクタリングとは、外部から見た動作を変えずに内部構造を改善すること。

## 確認フロー

```
Task Progress:
- [ ] Step 1: 対象コードを理解する
- [ ] Step 2: 原則に基づいてリファクタリング
- [ ] Step 3: 変更内容を説明
```

### Step 1: 対象コードを理解する

リファクタリング対象のファイルを読み、現状を把握する。

### Step 3: 原則に基づいてリファクタリング

以下の原則に従ってコードを改善する。

### Step 5: 変更内容を説明

ユーザーに変更内容を説明し、追加の修正が必要か確認する。

## リファクタリング原則

| 原則       | 説明                                       |
| ---------- | ------------------------------------------ |
| 関心の分離 | 影響範囲を限定する                         |
| 高凝集     | 関連する処理をまとめ、内部変更を容易にする |
| 疎結合     | 依存関係を減らす                           |
| 抽象化     | 変更耐性を高める                           |
| 非冗長     | 重複を排除する（DRY）                      |

## 実装指針

- **シンプルさを最優先する**
- オーバーエンジニアリングは禁止
- 常に最小限で設計・実装する
- ファイルの過剰な細分化を避ける
- 同一関心のファイルが 3 件以上 → 専用ディレクトリを提案（ユーザー確認後に実施）

## 禁止事項

- 動作を変える変更をリファクタリングと称すること
- 依頼範囲外のコードを勝手に変更すること

## チェックリスト

リファクタリング完了前に確認：

- [ ] 外部から見た動作が変わっていないか？
- [ ] コードがシンプルになったか？
- [ ] 依頼範囲外を変更していないか？

## 注意事項

1. **小さなステップで進める** - 一度に大きな変更をしない
2. **コミットを小さく** - 各リファクタリングごとにコミット可能な状態を維持
