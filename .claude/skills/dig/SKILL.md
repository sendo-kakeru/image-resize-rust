---
name: dig
description: 計画の曖昧な点を構造化された質問で明確化する。「計画を深掘りして」「仕様を詰めて」「曖昧な点を明確にして」といった依頼、または計画ファイルの不明点を解消する必要がある場合に使用する。
allowed-tools:
  - Write
  - Edit
  - Read
  - Grep
  - Glob
  - TodoRead
  - TodoWrite
  - AskUserQuestion
---

# 計画深掘りガイド

## 概要

**目的**: 計画ファイルの曖昧な点を構造化された質問で明確化し、仕様を確定させる。

現在の計画ファイルを読み込み、AskUserQuestion ツールを使って詳細にインタビューする。

対象となる領域:

- プロダクト仕様
- 技術的な詳細
- UI/UX
- その他すべて

すべての不明点が解消されるまで徹底的に深掘りし、仕様を計画ファイルに記載する。

---

## フェーズ 1: 計画ファイルの読み込みと分析

1. 計画ファイルを読み込む
2. 曖昧な点・未決定事項を洗い出す
3. 質問すべき項目をリストアップする

---

## フェーズ 2: 質問の生成

AskUserQuestion ツールを使って質問する。

<rules>
- 質問数: **2〜4問**（曖昧さのレベルに応じて調整）
- 各質問には **2〜4つの具体的な選択肢** を用意
- 各選択肢には **メリット/デメリット** を簡潔に記載
- 自由回答形式の質問は避ける
- 「その他」は自動追加されるため含めない
- CLAUDE.md の既存パターンに沿った選択肢にする（存在する場合）
</rules>

---

## フェーズ 3: 決定事項の反映

ユーザーの回答を受け取った後、以下の形式で出力し、計画ファイルに反映する。

<output_format>

## 決定事項

| 項目       | 選択         | 理由                   | 備考                       |
| ---------- | ------------ | ---------------------- | -------------------------- |
| データ保存 | データベース | スケーラビリティの要件 | マイグレーション戦略を検討 |

</output_format>

---

## フェーズ 4: 再分析

計画ファイルを再度分析し、新たな不明点があればフェーズ 2 に戻る。
不明点がなくなるまでフェーズ 2〜4 を繰り返す。

---

## フェーズ 5: サマリーの提示

すべての不明点が解消されたら、以下を出力する。

<output_format>

## 次のステップ

1. **最初のタスク**
   - 詳細...
2. **次のタスク**
   - 詳細...
     </output_format>

---

## 重要な注意事項

- **AskUserQuestion ツールを必ず使用** - 会話形式の質問は不可
- 各選択肢には **メリット/デメリット** を必ず含める
- multiSelect は控えめに使用（デフォルト: false）
- 質問生成前に CLAUDE.md を読み、プロジェクトのパターンに合わせる
